(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],{10:function(t,e,o){t.exports=o(16)},15:function(t,e,o){},16:function(t,e,o){"use strict";o.r(e);var r=o(0),n=o.n(r),a=o(9),i=o.n(a),l=(o(15),o(1)),s=o(2),c=o(3),u=o(6),m=o(5),h=o(4),f=o(7);var v=function(t){return n.a.createElement("div",null,"Lines Sent: "+t.linesCleared)};var d=function(t){return n.a.createElement("div",null,n.a.createElement(v,{linesCleared:t.linesCleared}))},y=Object.freeze({GHOST:"GHOST",NONE:"NONE",I:"I",J:"J",L:"L",O:"O",S:"S",T:"T",Z:"Z"}),p=Object.freeze({0:0,1:1,2:2,3:3}),b=60,O=Object.freeze({I:[[[1,0],[1,1],[1,2],[1,3]],[[0,2],[1,2],[2,2],[3,2]],[[2,0],[2,1],[2,2],[2,3]],[[0,1],[1,1],[2,1],[3,1]]],J:[[[0,0],[1,0],[1,1],[1,2]],[[0,1],[0,2],[1,1],[2,1]],[[1,0],[1,1],[1,2],[2,2]],[[0,1],[1,1],[2,0],[2,1]]],L:[[[0,2],[1,0],[1,1],[1,2]],[[0,1],[1,1],[2,1],[2,2]],[[1,0],[1,1],[1,2],[2,0]],[[0,0],[0,1],[1,1],[2,1]]],O:[[[0,1],[0,2],[1,1],[1,2]],[[0,1],[0,2],[1,1],[1,2]],[[0,1],[0,2],[1,1],[1,2]],[[0,1],[0,2],[1,1],[1,2]]],S:[[[0,1],[0,2],[1,0],[1,1]],[[0,1],[1,1],[1,2],[2,2]],[[1,1],[1,2],[2,0],[2,1]],[[0,0],[1,0],[1,1],[2,1]]],T:[[[0,1],[1,0],[1,1],[1,2]],[[0,1],[1,1],[1,2],[2,1]],[[1,0],[1,1],[1,2],[2,1]],[[0,1],[1,0],[1,1],[2,1]]],Z:[[[0,0],[0,1],[1,1],[1,2]],[[0,2],[1,1],[1,2],[2,1]],[[1,0],[1,1],[2,1],[2,2]],[[0,1],[1,0],[1,1],[2,0]]]}),T=function(){function t(e,o,r){Object(s.a)(this,t),this.type=e,this.offset=o,this.rotationState=r,this._layouts=O[e]}return Object(c.a)(t,[{key:"getPoints",value:function(){return this._layouts[this.rotationState]}},{key:"rotate",value:function(){this.rotationState+=1,this.rotationState=this.rotationState%4}}]),t}(),k=function(){function t(){Object(s.a)(this,t)}return Object(c.a)(t,[{key:"spawnTetromino",value:function(){var t=Object.keys(y);t.splice(t.indexOf(y.GHOST),2);var e=t[Math.floor(Math.random()*t.length)];return new T(e,[0,3],p[0])}},{key:"stablizeTetromino",value:function(t,e){var o=e.getPoints(),r=Object(l.a)(e.offset,2),n=r[0],a=r[1],i=!0,s=!1,c=void 0;try{for(var u,m=o[Symbol.iterator]();!(i=(u=m.next()).done);i=!0){var h=u.value,f=Object(l.a)(h,2),v=f[0],d=f[1];t[v+n][d+a]=e.type}}catch(y){s=!0,c=y}finally{try{i||null==m.return||m.return()}finally{if(s)throw c}}return t}},{key:"handleLineClears",value:function(t){for(var e=0,o=(t=t.map((function(t){return t.slice()}))).length-1;o>=0;o--){var r=t[o];10===r.filter((function(t){return t!==y.NONE})).length?(r.fill(y.NONE),e++):t=this.moveRowToIndex(t,o,o+e)}return[t,e]}},{key:"moveRowToIndex",value:function(t,e,o){return t[o]=t[e],t}},{key:"hasBoardOverflowed",value:function(t){return!1}},{key:"rotateTetromino",value:function(t,e){var o=Object(l.a)(e.offset,2),r=o[0],n=o[1],a=new T(e.type,[r,n],e.rotationState);return a.rotate(),a}},{key:"moveTetrominoLeft",value:function(t,e){var o=Object(l.a)(e.offset,2),r=o[0],n=o[1],a=!1,i=!0,s=!1,c=void 0;try{for(var u,m=e.getPoints()[Symbol.iterator]();!(i=(u=m.next()).done);i=!0){var h=u.value,f=Object(l.a)(h,2),v=f[0],d=f[1]+n-1,p=d<0,b=t[v+r][d]!==y.NONE;a=a||p||b}}catch(O){s=!0,c=O}finally{try{i||null==m.return||m.return()}finally{if(s)throw c}}return a?e:new T(e.type,[r,n-1],e.rotationState)}},{key:"moveTetrominoRight",value:function(t,e){var o=Object(l.a)(e.offset,2),r=o[0],n=o[1],a=!1,i=!0,s=!1,c=void 0;try{for(var u,m=e.getPoints()[Symbol.iterator]();!(i=(u=m.next()).done);i=!0){var h=u.value,f=Object(l.a)(h,2),v=f[0],d=f[1]+n+1,p=d<0,b=t[v+r][d]!==y.NONE;a=a||p||b}}catch(O){s=!0,c=O}finally{try{i||null==m.return||m.return()}finally{if(s)throw c}}return a?e:new T(e.type,[r,n+1],e.rotationState)}},{key:"isCollision",value:function(t,e){var o=Object(l.a)(e.offset,2),r=o[0],n=o[1],a=e.getPoints(),i=!0,s=!1,c=void 0;try{for(var u,m=a[Symbol.iterator]();!(i=(u=m.next()).done);i=!0){var h=u.value,f=Object(l.a)(h,2),v=f[0],d=f[1];if(v+r>=20)return!0;if(t[v+r][d+n]!==y.NONE)return!0}}catch(p){s=!0,c=p}finally{try{i||null==m.return||m.return()}finally{if(s)throw c}}return!1}},{key:"canTetrominoDrop",value:function(t,e){var o=this.dropTetromino(e);return!this.isCollision(t,o)}},{key:"dropTetromino",value:function(t){var e=Object(l.a)(t.offset,2),o=e[0],r=e[1];return new T(t.type,[o+1,r],t.rotationState)}},{key:"hardDropTetromino",value:function(t,e){for(;this.canTetrominoDrop(t,e);)e=this.dropTetromino(e);return e}},{key:"initBoard",value:function(){for(var t=[],e=0;e<20;e++){for(var o=[],r=0;r<10;r++)o.push(y.NONE);t.push(o)}return t}}]),t}();var w=function(t){var e="tetrominoCell "+t.type;return n.a.createElement("div",{className:e})},g=function(t){function e(t){var o;return Object(s.a)(this,e),(o=Object(u.a)(this,Object(m.a)(e).call(this,t))).controller=new k,o}return Object(f.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){var t=this.props.board.map((function(t){return t.slice()})),e=this.props.tetromino;if(e){var o=Object(l.a)(e.offset,2),r=o[0],a=o[1],i=e.getPoints(),s=this.controller.hardDropTetromino(this.props.board,e),c=Object(l.a)(s.offset,2),u=c[0],m=c[1],h=!0,f=!1,v=void 0;try{for(var d,p=i[Symbol.iterator]();!(h=(d=p.next()).done);h=!0){var b=d.value,O=Object(l.a)(b,2),T=O[0],k=O[1];t[T+r][k+a]=e.type,t[T+u][k+m]=y.GHOST}}catch(j){f=!0,v=j}finally{try{h||null==p.return||p.return()}finally{if(f)throw v}}}var g=t.map((function(t,e){var o=t.map((function(t,e){return n.a.createElement(w,{type:t,key:e})}));return n.a.createElement("div",{className:"tetrominoRow",key:e},o)}));return n.a.createElement("div",{className:"TetrisGamePanel"},g)}}]),e}(n.a.Component),j=function(t){function e(t){var o;return Object(s.a)(this,e),(o=Object(u.a)(this,Object(m.a)(e).call(this,t))).gameLoop={animationId:null,frameInterval:1e3/b,lastFrameUpdateTime:null,lastGameUpdateTime:null},o.controller=new k,o.focusRef=n.a.createRef(),o.state={gravity:.05,board:o.controller.initBoard(),tetromino:null,linesCleared:0},o.handleKeypress=o.handleKeyPress(Object(h.a)(o)),o.gameTick=o.gameTick.bind(Object(h.a)(o)),o}return Object(f.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){var t=Date.now();this.gameLoop.lastFrameUpdateTime=t,this.gameLoop.lastGameUpdateTime=t,this.gameLoop.animationId=window.requestAnimationFrame(this.gameTick),this.focusRef.current.focus()}},{key:"componentWillUnmount",value:function(){window.cancelAnimationFrame(this.gameLoop.animationId)}},{key:"handleKeyPress",value:function(t){switch(t.key){case"ArrowUp":this.handleRotateTetromino();break;case"ArrowLeft":this.handleMoveTetrominoLeft();break;case"ArrowRight":this.handleMoveTetrominoRight();break;case" ":this.handleHardDropTetromino()}}},{key:"handleRotateTetromino",value:function(){if(this.state.tetromino){var t=this.controller.rotateTetromino(this.state.board,this.state.tetromino);this.setState({tetromino:t})}}},{key:"handleMoveTetrominoLeft",value:function(){if(this.state.tetromino){var t=this.controller.moveTetrominoLeft(this.state.board,this.state.tetromino);this.setState({tetromino:t})}}},{key:"handleMoveTetrominoRight",value:function(){if(this.state.tetromino){var t=this.controller.moveTetrominoRight(this.state.board,this.state.tetromino);this.setState({tetromino:t})}}},{key:"handleHardDropTetromino",value:function(){var t=this;if(this.state.tetromino){var e=this.controller.hardDropTetromino(this.state.board,this.state.tetromino),o=this.controller.stablizeTetromino(this.state.board,e);this.setState({board:o,tetromino:null},(function(){t.updateGameState(Date.now(),!0)}))}}},{key:"gameTick",value:function(){var t=Date.now(),e=t-this.gameLoop.lastFrameUpdateTime;e>this.gameLoop.frameInterval&&(this.gameLoop.lastFrameUpdateTime=t-e%this.gameLoop.frameInterval,this.updateGameState(t)),this.gameLoop.animationId=window.requestAnimationFrame(this.gameTick)}},{key:"updateGameState",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=1e3/b/this.state.gravity,r=t-this.gameLoop.lastGameUpdateTime;if(r>o||e){this.gameLoop.lastGameUpdateTime=t;var n=this.state.board.map((function(t){return t.slice()})),a=this.state.tetromino,i=this.state.linesCleared;if(a)this.controller.canTetrominoDrop(n,a)?a=this.controller.dropTetromino(a):(n=this.controller.stablizeTetromino(n,a),a=null);else{var s=this.controller.handleLineClears(n),c=Object(l.a)(s,2),u=c[0],m=c[1];n=u,i+=m,this.controller.hasBoardOverflowed(n),a=this.controller.spawnTetromino()}this.setState({board:n,tetromino:a,linesCleared:i})}}},{key:"render",value:function(){var t=this;return n.a.createElement("div",{tabIndex:"1",onKeyDown:function(e){return t.handleKeyPress(e)},ref:this.focusRef},n.a.createElement(d,{linesCleared:this.state.linesCleared}),n.a.createElement(g,{board:this.state.board,tetromino:this.state.tetromino}))}}]),e}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(n.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[10,1,2]]]);
//# sourceMappingURL=main.b6470394.chunk.js.map